@page "{handler?}/{id?}"
@using BoardGameVoter.Models.EntityModels.BoardGames;
@using BoardGamer.BoardGameGeek.BoardGameGeekXmlApi2;
@model NewModel 
@{
    ViewData["Title"] = "Add New";
}
<form id="AddNew" method="post">
    <h1>@ViewData["Title"]</h1>
    <input asp-for="Search" class="form-control" />
    <button action="submit">Search</button>
    <table id="NewGameDatatable" class="table table-striped table-bordered dt-responsive">
        <thead>
            <tr>
                <th>Image</th>
                <th>Title</th>
                <th>Year</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            @{
                if (!string.IsNullOrEmpty(Model.Search) && Model.BGGSearchResults.Any())
                {
                    foreach (ThingResponse.Item _SearchResult in Model.BGGSearchResults)
                    {
                        <tr>
                            <td><img src="@_SearchResult.Thumbnail" /></td>
                            <td>@_SearchResult.Name</td>
                            <td>@_SearchResult.ReleaseDate.GetValueOrDefault().Year</td>
                            <td>
                                <button asp-page-handler="add" asp-route-id="@_SearchResult.Id">Add</button>
                            </td>
                        </tr>
                    }
                }
                else if (string.IsNullOrEmpty(Model.Search))
                {
                    foreach (BoardGame _BoardGame in Model.DBBoardGames)
                    {
                        <tr>
                            <td></td>
                            <td>@_BoardGame.Title</td>
                            <td>@_BoardGame.ReleaseDate.GetValueOrDefault().Year</td>
                            <td></td>
                        </tr>
                    }
                }
                else
                {
                    <h4>No Results</h4>
                }
            }
        </tbody>
    </table>
</form>
@section Scripts{
    <script src="~/js/Library/Add/New.js" asp-append-version="true"></script>
}
